<?xml version='1.0' encoding='UTF-8'?>

<synthetic xsi:schemaLocation="http://www.xebialabs.com/deployit/synthetic synthetic.xsd"
           xmlns="http://www.xebialabs.com/deployit/synthetic" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <type type="servicenowxl.Server" label="ServiceNow: Server" extends="configuration.HttpConnection">
        <property name="scriptLocation" default="servicenowxl/check_connection.py" hidden="true"/>
        <property name="changeRecordTableName" label="Change Record Table Name (Required for Generate Release)"
                  required="true" default="change_request"/>
        <property name="changeTaskTableName" label="Change Task Table Name (Required for Generate Release)"
                  required="true" default="change_task"/>
        <property name="sysparmDisplayValue" label="Retrieve display value" required="true" default="True"
                  kind="boolean" description="If true returns display values for all of the fields"/>
        <property name="sysparmInputDisplayValue" label="Input values are display values" required="true" default="True"
                  kind="boolean" description="If true treats input values as display values"/>
        <property name="useOAuth" label="Use ServiceNow OAuth Resource Server"
                  description="Use OAuth instead of basic authentication" required="false" category="OAuth"
                  kind="boolean"/>
        <property name="oauthUsername" label="Username" description="Mandatory if OAuth is enabled" required="false"
                  category="OAuth"/>
        <property name="oauthPassword" label="Password" description="Mandatory if OAuth is enabled" required="false"
                  password="true" category="OAuth"/>
        <property name="clientId" label="Client Id" description="Mandatory if OAuth is enabled" required="false"
                  category="OAuth"/>
        <property name="clientSecret" label="Client Secret" description="Mandatory if OAuth is enabled" required="false"
                  password="true" category="OAuth"/>
    </type>

    <type type="servicenowxl.Task" extends="xlrelease.PythonScript" virtual="true">
        <property name="iconLocation" default="servicenowxl/servicenow-icon.png" hidden="true"/>
        <property name="servicenowServer" category="input" label="Server" referenced-type="servicenowxl.Server" required="true"
                  kind="ci"/>
        <property name="username" category="input" required="false"/>
        <property name="password" password="true" category="input" required="false"/>
        <property name="data" category="output" kind="map_string_string"/>
    </type>

    <type type="servicenowxl.CreateRecord" extends="servicenowxl.Task" label="ServiceNow: Create Record">
        <property name="scriptLocation" default="servicenowxl/create_record.py" hidden="true"/>
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
        <property name="shortDescription" category="input" label="Short Description" required="true"/>
        <property name="comments" category="input" label="Comments" required="true"/>
        <property name="sysId" category="output"/>
        <property name="ticket" category="output"/>
    </type>

    <type type="servicenowxl.CreateNewRecord" extends="servicenowxl.Task" label="ServiceNow: Create New Record">
        <property name="scriptLocation" default="servicenowxl/create_new_record.py" hidden="true"/>
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
        <property name="content" category="input" label="Request Content" required="true" size="large"/>
        <property name="sysId"   category="output"/>
        <property name="ticket"  category="output"/>
    </type>

    <type type="servicenowxl.UpdateRecord" extends="servicenowxl.Task" label="ServiceNow: Update Record">
        <property name="scriptLocation" default="servicenowxl/update_record.py" hidden="true"/>
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
        <property name="sysId" category="input" required="true"/>
        <property name="content" category="input" label="Request Content" required="true" size="large"/>
    </type>

    <type type="servicenowxl.FindRecordByTicket" extends="servicenowxl.Task" label="ServiceNow: Find Record By Ticket">
        <property name="scriptLocation" default="servicenowxl/find_record.py" hidden="true"/>
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
        <property name="ticket" category="input" required="true"/>
        <property name="sysId" category="output"/>
    </type>


    <!--
       #######################################################################################################################
       #    Incident Requests
       #######################################################################################################################
   -->
    <type type="servicenowxl.CreateIncident" extends="servicenowxl.CreateRecord" label="ServiceNow: Create Incident">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.CreateNewIncident" extends="servicenowxl.CreateNewRecord" label="ServiceNow: Create New Incident">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.UpdateIncident" extends="servicenowxl.UpdateRecord" label="ServiceNow: Update Incident">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.FindIncidentByTicket" extends="servicenowxl.FindRecordByTicket" label="ServiceNow: Find Incident By Ticket">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true"
                  hidden="true"/>
    </type>

    <!--
       #######################################################################################################################
       #    Service Requests
       #######################################################################################################################
   -->
    <type type="servicenowxl.CreateServiceRequest" extends="servicenowxl.CreateRecord" label="ServiceNow: Create ServiceRequest">
        <property name="tableName" category="input" default="sc_request" required="true" hidden="true"/>
    </type>

    <type type="servicenowxl.CreateNewServiceRequest" extends="servicenowxl.CreateNewRecord" label="ServiceNow: Create New ServiceRequest">
        <property name="tableName" category="input" default="sc_request" required="true" hidden="true"/>
    </type>

    <type type="servicenowxl.UpdateServiceRequest" extends="servicenowxl.UpdateRecord" label="ServiceNow: Update ServiceRequest">
        <property name="tableName" category="input" default="sc_request" required="true" hidden="true"/>
    </type>

    <type type="servicenowxl.FindServiceRequestItemByTicket" extends="servicenowxl.FindRecordByTicket"  label="ServiceNow: Find ServiceRequest">
        <property name="tableName" category="input" default="sc_request" required="true" hidden="true"/>
    </type>

    <!--
       #######################################################################################################################
       #    Service Request Items
       #######################################################################################################################
   -->
    <type type="servicenowxl.CreateRequestItem" extends="servicenowxl.CreateRecord" label="ServiceNow: Create Request Item">
        <property name="tableName" category="input" label="Table Name" default="sc_req_item" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.CreateNewRequestItem" extends="servicenowxl.CreateNewRecord"  label="ServiceNow: Create New Request Item">
        <property name="tableName" category="input" label="Table Name" default="sc_req_item" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.UpdateRequestItem" extends="servicenowxl.UpdateRecord"  label="ServiceNow: Update Request Item">
        <property name="tableName" category="input" label="Table Name" default="sc_req_item" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.FindRequestItemByTicket" extends="servicenowxl.FindChangeRequestByTicket"  label="ServiceNow: Find Request Item">
        <property name="tableName" category="input" label="Table Name" default="sc_req_item" required="true"
                  hidden="true"/>
    </type>

    <!--
       #######################################################################################################################
       #    Change Requests
       #######################################################################################################################
   -->
    <type type="servicenowxl.CreateChangeRequest" extends="servicenowxl.CreateRecord" label="ServiceNow: Create ChangeRequest">
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.CreateNewChangeRequest" extends="servicenowxl.CreateNewRecord" label="ServiceNow: Create New ChangeRequest">
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.UpdateChangeRequest" extends="servicenowxl.UpdateRecord" label="ServiceNow: Update ChangeRequest">
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.FindChangeRequestByTicket" extends="servicenowxl.FindRecordByTicket" label="ServiceNow: Find ChangeRequest">
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.FindChangeTaskByTaskId" extends="servicenowxl.FindRecordByTicket" label="ServiceNow: Find ChangeTask">
        <property name="tableName" category="input" label="Table Name" default="change_task" required="true"
                  hidden="true"/>
    </type>

    <type type="servicenowxl.RequestApproval" extends="servicenowxl.Task" label="ServiceNow: Request Approval">
        <property name="scriptLocation" default="servicenowxl/request_approval.py" hidden="true"/>

        <property name="shortDescription" category="input" label="Short Description" required="true"/>
        <property name="description" category="input" label="Description" required="true"/>
        <property name="content"
                  default="{&quot;short_description&quot;:&quot;%s&quot;,&quot;description&quot;:&quot;%s&quot;,&quot;category&quot;:&quot;XLDeploy&quot;,&quot;u_supporting_service&quot;:&quot;Exchange Support&quot;,&quot;assignment_group&quot;:&quot;Global Software Change Group&quot;,&quot;justification&quot;:&quot;XLDeploy&quot;,&quot;requested_by_date&quot;:&quot;08-08-2014&quot;}"
                  category="input" hidden="true"/>
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="true"/>

        <property name="sysId" category="output"/>
        <property name="ticket" category="output"/>
    </type>

    <type type="servicenowxl.PollingCheckStatus" extends="servicenowxl.Task" label="ServiceNow: Poll ChangeRequest Status">
        <property name="scriptLocation" default="servicenowxl/poll_change_request_status.py" hidden="true"/>

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true"
                  hidden="false"/>
        <property name="sysId" category="input" label="System ID" required="true"/>
        <property name="pollInterval" category="input" kind="integer" label="Polling Interval" required="true"
                  default="30"/>
        <property name="statusField" category="input" label="Status Field" required="true" default="state"/>
        <property name="checkForStatus" category="input" label="Status Value to check for" required="true"/>

        <property name="status" category="output"/>
        <property name="ticket" category="output"/>
        <property name="data" category="output" kind="map_string_string"/>
    </type>

    <type type="servicenowxl.GetChangeRequest" extends="servicenowxl.Task" label="ServiceNow: Get ChangeRequest">
        <property name="scriptLocation" default="servicenowxl/get_change_request.py" hidden="true"/>

        <property name="tableName" category="input" default="change_request" required="true" hidden="true"/>
        <property name="number" category="input" label="Number" required="true"/>
        <property name="fieldNames" category="input" label="Field Names" required="true" kind="list_of_string"
                  description="List of field names to be displayed"/>
    </type>

    <type type="servicenowxl.CheckChangeRequest" extends="servicenowxl.Task" label="ServiceNow: Check ChangeRequest">
        <property name="scriptLocation" default="servicenowxl/check_change_request.py" hidden="true"/>

        <property name="tableName" category="input" default="change_request" required="true" hidden="true"/>
        <property name="expectedStatus" category="input" default="Closed Complete,Closed Incomplete,Closed Skipped"
                  hidden="true"/>

        <property name="number" category="input" label="Number" required="true"/>
    </type>

</synthetic>

